{% extends 'main/base.html' %}

{% block content %}
<div class="container mt-4">
    <h2>Управление бронированиями</h2>
    <table class="table table-bordered mt-3">
        <thead>
            <tr>
                <th>Событие</th>
                <th>Дата</th>
                <th>Время</th>
                <th>До</th>
                <th>Длительность (ч)</th>
                <th>Пользователь</th>
                <th>Действия</th>
            </tr>
        </thead>
        <tbody>
            {% for booking in bookings %}
            <tr>
                <td>{{ booking.event_name }}</td>
                <td>{{ booking.date }}</td>
                <td>{{ booking.time|time:"H:i" }}</td>
                <td>
                    {% with booking.date|date:"Y-m-d" as d %}
                        {% with booking.time|date:"H:i" as t %}
                            {% with booking.duration|floatformat:0 as dur %}
                                {% with booking.time|add:"0"|date:"U"|add:dur|date:"H:i" as end_time %}
                                    {{ end_time }}
                                {% endwith %}
                            {% endwith %}
                        {% endwith %}
                    {% endwith %}
                </td>
                <td>{{ booking.duration }}</td>
                <td>{{ booking.user.username }}</td>
                <td>
                    <a href="{% url 'edit_booking' booking.id %}" class="btn btn-sm btn-primary">Редактировать</a>
                    <a href="{% url 'delete_booking' booking.id %}" class="btn btn-sm btn-danger">Удалить</a>
                </td>
            </tr>
            {% empty %}
            <tr><td colspan="7">Нет бронирований</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
